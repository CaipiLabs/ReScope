module.exports=function(t){function e(n){if(i[n])return i[n].exports;var s=i[n]={exports:{},id:n,loaded:!1};return t[n].call(s.exports,s,s.exports,e),s.loaded=!0,s.exports}var i={};return e.m=t,e.c=i,e.p="/",e(0)}([function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var s=i(2),r=n(s),a=i(5),o=n(a);r.default.Store=o.default,e.default={Store:o.default,Context:r.default},t.exports=e.default},function(t,e){t.exports=require("is")},function(t,e,i){"use strict";function n(t){if(Array.isArray(t)){for(var e=0,i=Array(t.length);e<t.length;e++)i[e]=t[e];return i}return Array.from(t)}function s(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var u=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),l=i(1),h=i(3),c=i(4),_=function(t,e,i){var n=function(){};n.prototype=i?new i["_"+e]:t[e]||{},t[e]=new n,t["_"+e]=n},f={},p=function(t){function e(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=i.id,s=i.parent,o=i.state,u=i.data,l=(i.name,i.incrementId),h=i.defaultMaxListeners,p=i.persistenceTm,d=i.autoDestroy,v=i.rootEmitter;r(this,e);var y=a(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));if(y._maxListeners=h||y.constructor.defaultMaxListeners,n=n||"_____"+c.generate(),f[n]&&!l){var b;return y._id=n,f[n].register(t),b=f[n],a(y,b)}if(f[n]&&l){for(var m=-1;f[n+"/"+ ++m];);n=n+"/"+m}if(y._id=n,f[n]=y,y._isLocalId=!0,y._persistenceTm=p||y.constructor.persistenceTm,y.stores={},y.state={},y.data={},s&&s.dead)throw new Error("Can't use a dead context as parent !");return _(y,"stores",s),_(y,"state",s),_(y,"data",s),y.parent=s,y.sources=[],y._childContexts=[],y._childContextsList=[],y._unStableChilds=0,y.__retains={all:0},y.__locks={all:1},y.__listening={},y.__context={},y.__mixed=[],y.__mixedList=[],y._followers=[],s&&(s.retain("isMyParent"),v?s.on(y.__parentList={update:function(t){return y._propag()}}):(!s._stable&&y.wait("waitingParent"),s.on(y.__parentList={stable:function(t){return y.release("waitingParent")},unstable:function(t){return y.wait("waitingParent")},update:function(t){return y._propag()}}))),y.register(t,o,u),y.__locks.all--,y._stable=!y.__locks.all,s&&s._addChild(y),d&&setTimeout(function(t){y.retain("autoDestroy"),y.dispose("autoDestroy")}),y}return o(e,t),u(e,null,[{key:"getContext",value:function(t){var i=l.array(t)?t.sort(function(t,e){return t.firstname<e.firstname?-1:t.firstname>e.firstname?1:0}).join("::"):t;return f[i]=f[i]||new e({},{id:i})}}]),u(e,[{key:"mount",value:function(t,e,i){var n=this;return l.array(t)?t.forEach(function(t){return n._mount(t,e&&e[t],i&&i[t])}):this._mount.apply(this,arguments),this}},{key:"_mount",value:function(t,e,i){if("string"!=typeof t&&(this.register(s({},t.name,t.store)),t=t.name),!this.__context[t]){var n;if(this.__mixed.reduce(function(n,s){return n||s._mount(t,e,i)},!1)||!this.parent)return;return(n=this.parent)._mount.apply(n,arguments)}var r=this.__context[t];return l.fn(r)?this.__context[t]=new r(this,{state:e,data:i}):(void 0!==e&&void 0===i?r.setState(e):void 0!==e&&(r.state=e),void 0!==i&&r.push(i)),this._watchStore(t),this.__context[t]}},{key:"_watchStore",value:function(t,e,i){var n=this;if(!this.__context[t]){var s;if(this.__mixed.reduce(function(n,s){return n||s._watchStore(t,e,i)},!1)||!this.parent)return;return(s=this.parent)._watchStore.apply(s,arguments)}return this.__listening[t]||l.fn(this.__context[t])||(!this.__context[t].isStable()&&this.wait(t),this.__context[t].on(this.__listening[t]={destroy:function(e){delete n.__listening[t],n.__context[t]=n.__context[t].constructor},update:function(t){return n.propag()},stable:function(e){return n.release(t)},unstable:function(e){return n.wait(t)}})),!0}},{key:"mixin",value:function(t){var e=this,i=this.parent,n=void 0;this.__mixed.push(t),t.retain("mixedTo"),t._stable||this.wait(t._id),this.__mixedList.push(n={stable:function(i){return e.release(t._id)},unstable:function(i){return e.wait(t._id)},update:function(t){return e._propag()}}),this.stores={},this.state={},this.data={},t.on(n),_(this,"stores",i),_(this,"state",i),_(this,"data",i),this.relink(this.__context,this,!1,!0),this.__mixed.forEach(function(t){_(e,"stores"),_(e,"state"),_(e,"data"),t.relink(t.__context,e,!0,!0)})}},{key:"register",value:function(t){var e=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.relink(t,this,!1,!1),Object.keys(t).forEach(function(s){t[s].singleton||l.fn(t[s])&&(i[s]||n[s])?e._mount(s,i[s],n[s]):i[s]||n[s]?n[s]?(i[s]&&(e.stores[s].state=i[s]),e.stores[s].push(n[s])):i[s]&&e.stores[s].setState(i[s]):e._watchStore(s)})}},{key:"relink",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this,i=this,n=arguments[2],s=arguments[3],r=e._stores.prototype;Object.keys(t).forEach(function(a){if(!(!s&&e.__context[a]===t[a]||e.__context[a]&&e.__context[a].constructor===t[a])){if(!s&&e.__context[a])return n||l.fn(e.__context[a])||(e.__context[a].__proto__=t[a].prototype),void(!n&&l.fn(e.__context[a])&&(e.__context[a]=t[a]));s||n||(i.__context[a]=t[a]),Object.defineProperty(r,a,{get:function(){return i.__context[a]}}),Object.defineProperty(e._state.prototype,a,{get:function(){return i.__context[a]&&i.__context[a].state},set:function(t){return i._mount(a,t)}}),Object.defineProperty(e._data.prototype,a,{get:function(){return i.__context[a]&&i.__context[a].data},set:function(t){return i._mount(a,void 0,t)}})}})}},{key:"bind",value:function(t,e,i){var n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],r=void 0,a=void 0,o=void 0;if(e&&!l.array(e)&&(e=[e]),i!==!1&&i!==!0||(n=i,i=null),o=e.map(function(t){return l.string(t)?t:t.name}),this._followers.push([t,e,i||void 0,r=o&&o.reduce(function(t,e){return t[e]=0,t},{})]),this.mount(e),n&&this._stable){if(a=this.getUpdates(r),!a)return;"function"!=typeof t?i?t.setState(s({},i,a)):t.setState(a):t(a)}return this}},{key:"unBind",value:function(t,e,i){for(var n=this._followers,s=n&&n.length;n&&s--;)if(n[s][0]===t&&""+n[s][1]==""+e&&n[s][2]==i)return n.splice(s,1)}},{key:"map",value:function(t,e){var i=this,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],s=this.constructor.Store;if(e=l.array(e)?e:[e],this.mount(e),n&&t instanceof s)s.map(t,e,this,this,!1);else if(n){this.bind(t,e,void 0,!1);var r=void 0,a=t.isReactComponent?"componentWillUnmount":"destroy";t.hasOwnProperty(a)&&(r=t[a]),t[a]=function(){return delete t[a],r&&(t[a]=r),i.unBind(t,e),t[a]&&t[a].apply(t,arguments)}}return e.reduce(function(t,e){return l.string(e)||(e=e.name),e=e.split(":"),e[0]=e[0].split("."),t[e[1]||e[0][e[0].length-1]]=i.stores[e[0][0]]&&i.stores[e[0][0]].retrieve&&i.stores[e[0][0]].retrieve(e[0].splice(1)),t},{})}},{key:"retrieve",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return t=l.string(t)?t.split("."):t,t&&this.stores[t[0]]&&this.stores[t[0]].retrieve(t.splice(1))}},{key:"getStoresRevs",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments[1],i=this.__context;return t||(t={}),Object.keys(i).forEach(function(e){l.fn(i[e])?t.hasOwnProperty(e)||(t[e]=!1):t[e]=i[e]._rev}),e||(this.__mixed.reduce(function(e,i){return i.getStoresRevs(t),t},t),this.parent&&this.parent.getStoresRevs(t)),t}},{key:"getUpdates",value:function(t,e,i){var n=this,s=this.__context;return e=e||{},Object.keys(s).forEach(function(r){e[r]||t&&(!t.hasOwnProperty(r)||void 0!==t[r])&&(!t.hasOwnProperty(r)||s[r]._rev<=t[r])||(i=!0,e[r]=n.data[r],t&&void 0!==t[r]&&(t[r]=s[r]._rev))}),i=this.__mixed.reduce(function(i,n){return n.getUpdates(t,e,i)||i},i),i=this.parent&&this.parent.getUpdates(t,e,i)||i,i&&e}},{key:"serialize",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:/.*/,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:/.*/,n=this.__context,s={state:{},data:{}};return l.array(e)&&e.forEach(function(e){return s.state[e]=t.state[e]}),l.array(i)&&i.forEach(function(e){return s.data[e]=t.data[e]}),l.array(i)||l.array(e)||Object.keys(n).forEach(function(r){if(!l.fn(n[r])){var a=n[r].constructor.flags;a=l.array(a)?a:[a||""],a.reduce(function(t,i){return t||e.test(i)},!1)&&(s.state[r]=t.state[r]),a.reduce(function(t,e){return t||i.test(e)},!1)&&(s.data[r]=t.data[r])}}),s}},{key:"dispatch",value:function(t,e){var i=this;return Object.keys(this.__context).forEach(function(n){l.fn(i.__context[n])||i.__context[n].trigger(t,e)}),this.__mixed.forEach(function(i){return i.dispatch(t,e)}),this.parent&&this.parent.dispatch(t,e),this}},{key:"then",value:function(t){var e=this;return this._stable?t(null,this.data):void this.once("stable",function(i){return t(null,e.data)})}},{key:"restore",value:function(t,e){var i=t.state,n=t.data,s=this.__context;Object.keys(n).forEach(function(t){e?s.data=n[t]:s.push(n[t])}),Object.keys(i).forEach(function(t){e?s.state=i[t]:s.setState(i[t])})}},{key:"retainStores",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],i=arguments[1];e.forEach(function(e){return t.stores[e]&&t.stores[e].retain&&t.stores[e].retain(i)})}},{key:"disposeStores",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],i=arguments[1];e.forEach(function(e){return t.stores[e]&&t.stores[e].dispose&&t.stores[e].dispose(i)})}},{key:"wait",value:function(t){this._stable&&!this.__locks.all&&this.emit("unstable",this),this._stable=!1,this.__locks.all++,t&&(this.__locks[t]=this.__locks[t]||0,this.__locks[t]++)}},{key:"release",value:function(t){var e=this;t&&(0==this.__locks[t],this.__locks[t]=this.__locks[t]||0,this.__locks[t]--),!t&&0==this.__locks.all,this.__locks.all--,this.__locks.all||(this._stabilizerTM&&clearTimeout(this._stabilizerTM),this._stabilizerTM=setTimeout(function(t){e._stabilizerTM=null,e.__locks.all||(e._propagTM&&clearTimeout(e._propagTM),e._stable=!0,e.emit("stable",e),!e.dead&&e._propag())}))}},{key:"propag",value:function(){var t=this;this._propagTM&&clearTimeout(this._propagTM),this._propagTM=setTimeout(function(e){t._propagTM=null,t._propag()},2)}},{key:"_propag",value:function(){var t=this;this._followers.length&&this._followers.forEach(function(e){var i=e[0],r=(e[1],e[2]),a=e[3],o=t.getUpdates(a);o&&("function"!=typeof i?r?i.setState(s({},r,o)):i.setState(o):i(o,a&&[].concat(n(a))||"no revs"))}),this.emit("update",this.getUpdates())}},{key:"isStable",value:function(){return this._stable}},{key:"_addChild",value:function(t){var e=this;this._childContexts.push(t);var i={stable:function(t){e._unStableChilds--,e._unStableChilds||e.emit("stableTree",e)},unstable:function(t){e._unStableChilds++,1==e._unStableChilds&&e.emit("unstableTree",e)},stableTree:function(t){e._unStableChilds--,e._unStableChilds||e.emit("stableTree",e)},unstableTree:function(t){e._unStableChilds++,1==e._unStableChilds&&e.emit("unstableTree",e)},destroy:function(t){t._unStableChilds&&e._unStableChilds--,t.isStable()||e._unStableChilds--,e._unStableChilds||e.emit("stableTree",e)}},n=this._unStableChilds;!t.isStable()&&this._unStableChilds++,t._unStableChilds&&this._unStableChilds++,this._childContextsList.push(i),!n&&this._unStableChilds&&this.emit("unstableTree",this),t.on(i)}},{key:"_rmChild",value:function(t){var e=this._childContexts.indexOf(t),i=this._unStableChilds;e!=-1&&(this._childContexts.splice(e,1),!t.isStable()&&this._unStableChilds--,t._unStableChilds&&this._unStableChilds--,t.un(this._childContextsList.splice(e,1)[0]),i&&!this._unStableChilds&&this.emit("stableTree"))}},{key:"retain",value:function(t){this.__retains.all++,t&&(this.__retains[t]=this.__retains[t]||0,this.__retains[t]++)}},{key:"dispose",value:function(t){var e=this;if(t){if(0==this.__retains[t])throw new Error("Dispose more than retaining !");this.__retains[t]=this.__retains[t]||0,this.__retains[t]--}if(0==this.__retains.all)throw new Error("Dispose more than retaining !");this.__retains.all--,this.__retains.all||(this._persistenceTm?(this._destroyTM&&clearTimeout(this._destroyTM),this._destroyTM=setTimeout(function(t){e.then(function(t){!e.__retains.all&&e.destroy()})},this._persistenceTm)):this.then(function(t){return!e.__retains.all&&e.destroy()}))}},{key:"destroy",value:function(){var t=this;for(this.__context,this.dead=!0,this.emit("destroy",this),Object.keys(this.__listening).forEach(function(e){return t.__context[e].removeListener(t.__listening[e])}),this._stabilizerTM&&clearTimeout(this._stabilizerTM),this._propagTM&&clearTimeout(this._propagTM),this.__listening={},this._isLocalId&&delete f[this._id],this._followers.length=0;this.__mixedList.length;)this.__mixed[0].removeListener(this.__mixedList.shift()),this.__mixed.shift().dispose("mixedTo");this.__parentList&&(this.parent._rmChild(this),this.parent.removeListener(this.__parentList),this.parent.dispose("isMyParent"),this.__parentList=null),this.__mixed=this.data=this.state=this.context=this.stores=null,this._data=this._state=this._stores=null}},{key:"datas",get:function(){return this.data}}]),e}(h);p.persistenceTm=1,p.Store=null,p.contexts=f,e.default=p,t.exports=e.default},function(t,e,i){"use strict";function n(t){if(Array.isArray(t)){for(var e=0,i=Array(t.length);e<t.length;e++)i[e]=t[e];return i}return Array.from(t)}function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),a=i(1),o=function(){function t(){s(this,t),this._events={}}return r(t,[{key:"on",value:function(t,e){var i=this;return!a.string(t)&&t?Object.keys(t).forEach(function(e){return i.on(e,t[e])}):(this._events[t]=this._events[t]||[],void this._events[t].push(e))}},{key:"un",value:function(t,e){var i=this;if(!a.string(t)&&t)return Object.keys(t).forEach(function(e){return i.un(e,t[e])});if(this._events[t]){var n=this._events[t].indexOf(e);this._events[t].splice(n,1)}}},{key:"emit",value:function(t){if(this._events[t]){for(var e=[].concat(n(this._events[t])),i=arguments.length,s=Array(i>1?i-1:0),r=1;r<i;r++)s[r-1]=arguments[r];for(var a=0;a<e.length;a++)e[a].apply(e,s)}}},{key:"addListener",value:function(){this.on.apply(this,arguments)}},{key:"removeListener",value:function(){this.un.apply(this,arguments)}},{key:"removeAllListeners",value:function(){this._events={}}},{key:"once",value:function(t,e){var i=this,n=void 0;this.on(t,n=function(){i.un(t,n),e.apply(void 0,arguments)})}}]),t}();e.default=o,t.exports=e.default},function(t,e){t.exports=require("shortid")},function(t,e,i){"use strict";function n(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function s(t){if(Array.isArray(t)){for(var e=0,i=Array(t.length);e<t.length;e++)i[e]=t[e];return i}return Array.from(t)}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var u=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t},l=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),h=function t(e,i,n){null===e&&(e=Function.prototype);var s=Object.getOwnPropertyDescriptor(e,i);if(void 0===s){var r=Object.getPrototypeOf(e);return null===r?void 0:t(r,i,n)}if("value"in s)return s.value;var a=s.get;return void 0!==a?a.call(n):void 0},c=i(1),_=i(2),f=i(3),p=i(4),d=Object.getPrototypeOf({}),v=function(t){function e(){var t,i;r(this,e);var n=a(this,(e.__proto__||Object.getPrototypeOf(e)).call(this)),o=[].concat(Array.prototype.slice.call(arguments)),l=n.constructor,h=o[0]instanceof _?o.shift():l.context?_.getContext(l.context):c.string(o[0])?_.getContext(o.shift()):l.staticContext,f=!o[0]||c.array(o[0])||c.string(o[0])?{}:o.shift(),d=c.string(o[0])?o[0]:f.name||l.name,v=c.array(o[0])?o.shift():f.use||[],y=c.fn(o[0])?o.shift():f.apply||null,b=l.state||l.initialState;return n._uid=f._uid||p.generate(),n.__retains={all:0},n.__locks={all:0},n._onStabilize=[],n._persistenceTm=f.persistenceTm||n.constructor.persistenceTm,c.string(o[0])&&(h.__context[d],h.__context[d]=n),f&&f.on&&n.on(f.on),n.name=d,h.stores?(n.contextObj=h,n.context=h.stores):(n.contextObj=new _(h),n.context=h.stores),n._rev=0,n._revs={},n.stores={},n._require=[],c.array(l.use)?n._use=[].concat(s(v),s((l.use||[]).map(function(t){var e=t.match(/^(\!?)([^\:]*)(?:\:(.*))?$/);if(e[1]){var i=e[2].split(".");n._require.push(e[3]||i[i.length-1])}return e[2]}))):n._use=[].concat(s(v),s(l.use?Object.keys(l.use).map(function(t){var e=t.match(/^(\!?)(.*)$/);return e[1]&&n._require.push(l.use[t]),e[2]+":"+l.use[t]}):[])),l.require&&(t=n._require).push.apply(t,s(l.require)),f.require&&(i=n._require).push.apply(i,s(f.require)),n._followers=[],void 0!==l.data&&(n.data=u({},l.data)),f.hasOwnProperty("data")&&void 0!==f.data&&(n.data=f.data),f.hasOwnProperty("state")&&void 0!==f.state&&(b=u({},b,f.state)),y&&(n.apply=y),(b||n._use.length)&&(n.state=u({},b||{},h.map(n,n._use)),n.shouldApply(n.state)&&void 0===n.data&&(n.data=n.apply(n.data,n.state,n.state))),void 0!==n.data?(n._stable=!0,n._rev++):(n._stable=!1,!(l.managed||n.state||n._use&&n._use.length)),!n._stable&&n.emit("unstable",n.state),n}return o(e,t),l(e,[{key:"shouldPropag",value:function(t){var e,i=(this.constructor,this.data);return e=!i&&t,i&&Object.keys(i).forEach(function(n){e=e||(t?i[n]!==t[n]:i&&i[n])}),t&&Object.keys(t).forEach(function(n){e=e||(t?i[n]!==t[n]:i&&i[n])}),!!e}},{key:"shouldApply",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.state,i=this.constructor;return!!this.isComplete(e)&&(c.array(i.follow)?i.follow.reduce(function(t,i){return t||e&&e[i]},!1):!i.follow||Object.keys(i.follow).reduce(function(n,s){return n||e&&c.fn(i.follow[s])&&i.follow[s].call(t,e[s])||i.follow[s]&&e[s]!==t.state[s]},!1))}},{key:"apply",value:function(t,e,i){return e=e||this.state,this.refine?this.refine.apply(this,arguments):t&&t.__proto__===d&&e.__proto__===d?u({},t,e):e}},{key:"refine",value:function(t,e,i){return e=e||this.state,t&&t.__proto__===d&&e.__proto__===d?u({},t,e):e}},{key:"stabilize",value:function(t){var e=this;t&&this.once("stable",t),this._stable&&this.emit("unstable",this.state,this.data),this._stable=!1,this._stabilizer&&clearTimeout(this._stabilizer),this._stabilizer=setTimeout(this.push.bind(this,null,function(){var t=e._stable;e._stable=!0,!t&&e.emit("stable",e.state,e.data),e._stabilizer=null}))}},{key:"retrieve",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.data;return t=c.string(t)?t.split("."):t,i&&t&&t.length?t.length==e+1?i[t[e]]:this.retrieve(t,e+1,i[t[e]]):i}},{key:"dispatch",value:function(t){for(var e,i=arguments.length,n=Array(i>1?i-1:0),s=1;s<i;s++)n[s-1]=arguments[s];(e=this.contextObj).dispatch.apply(e,[t].concat(n))}},{key:"trigger",value:function(t){var e=this.constructor.actions,i=void 0;if(e&&e[t]){for(var n,s=arguments.length,r=Array(s>1?s-1:0),a=1;a<s;a++)r[a-1]=arguments[a];i=(n=e[t]).call.apply(n,[this].concat(r)),i&&this.setState(i)}}},{key:"pull",value:function(t,e,i){var n=this,s=this.contextObj.map(this,t);return e&&(this.wait(),t.forEach(function(t){return n.context[t]&&n.wait(n.context[t])}),this.release()),s}},{key:"push",value:function(t,e,i){i=e===!0?i:e,e=e===!0;var n=!t&&u({},this.state,this._changesSW)||this.state,s=t||this.apply(this.data,n,this._changesSW);return this.state=n,e||(this.data||this.data!==s)&&this.shouldPropag(s)?(this.data=s,this._changesSW={},this.wait(),void this.release(i)):(i&&i(),!1)}},{key:"setState",value:function(t,e,i){var n,s=this._changesSW=this._changesSW||{};for(var r in t)(!this.state||t.hasOwnProperty(r)&&(t[r]!=this.state[r]||this.state[r]&&t[r]&&t[r]._rev!=this._revs[r]))&&(n=!0,this._revs[r]=t[r]&&t[r]._rev||!0,s[r]=t[r]);if(this.shouldApply(u({},this.state,s)))return i?(this.push(),e&&e()):n?this.stabilize(e):e&&e(),this}},{key:"setStateSync",value:function(t){var e,i=this._changesSW=this._changesSW||{};for(var n in t)(!this.state||t.hasOwnProperty(n)&&(t[n]!=this.state[n]||this.state[n]&&t[n]&&t[n]._rev!=this._revs[n]))&&(e=!0,this._revs[n]=t[n]&&t[n]._rev||!0,i[n]=t[n]);return this.shouldApply(u({},this.state||{},i))&&this.push(),this.data}},{key:"replaceState",value:function(t,e){this.state=t,this.stabilize(e)}},{key:"as",value:function(t){return{store:this,name:t}}},{key:"on",value:function(t){var i=this;!c.string(t)&&t?Object.keys(t).forEach(function(n){return h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"on",i).call(i,n,t[n])}):h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"on",this).apply(this,arguments)}},{key:"removeListener",value:function(t){var i=this;!c.string(t)&&t?Object.keys(t).forEach(function(n){return h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"removeListener",i).call(i,n,t[n])}):h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"removeListener",this).apply(this,arguments)}},{key:"relink",value:function(t){var e=this,i=this.contextObj,n=this.constructor;n.use&&this.pull(n.use,!1,t),this._require&&this._require.forEach(function(t){return e.wait(i.__context[t])})}},{key:"isComplete",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.state;return this.constructor,!this._require||!this._require.length||t&&this._require.reduce(function(e,i){return e&&t[i]},!0)}},{key:"isStable",value:function(){return this._stable}},{key:"unBind",value:function(t,e,i){for(var n=this._followers,s=n&&n.length;n&&s--;)if(n[s][0]===t&&n[s][1]===e&&n[s][2]===i)return n.splice(s,1)}},{key:"bind",value:function(t,e){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],s=arguments[3];if(this._followers.push([t,e,s]),i&&this.data&&this._stable){var r=s?this.retrieve(s):this.data;"function"!=typeof t?e?t.setState(n({},e,r)):t.setState(r):t(r)}}},{key:"then",value:function(t){var e=this;return this._stable?t(null,this.data):void this.once("stable",function(i){return t(null,e.data)})}},{key:"wait",value:function(t){if("number"==typeof t)return this.__locks.all+=t;if(c.array(t))return t.map(this.wait.bind(this));this._stable&&this.emit("unstable",this.state,this.data),this._stable=!1,this.__locks.all++;var e=c.string(t)?t:null;return e&&(this.__locks[e]=this.__locks[e]||0,this.__locks[e]++),t&&c.fn(t.then)&&t.then(this.release.bind(this,null)),this}},{key:"release",value:function(t,e){var i=this,s=(this.constructor,this._stable);return c.fn(t)&&(e=t,t=null),t&&(0==this.__locks[t],this.__locks[t]=this.__locks[t]||0,this.__locks[t]--),!t&&0==this.__locks.all,!--this.__locks.all&&this.data&&this.isComplete()?(this._stable=!0,this._rev++,this._followers.length&&this._followers.forEach(function(t){var e=t[2]?i.retrieve(t[2]):i.data;e&&("function"==typeof t[0]?t[0](e):t[0].setState(t[1]?n({},t[1],e):e))}),!s&&this.emit("stable",this.data),this.emit("update",this.data),e&&e()):e&&this.then(e),this}},{key:"retain",value:function(t){this.__retains.all++,t&&(this.__retains[t]=this.__retains[t]||0,this.__retains[t]++)}},{key:"dispose",value:function(t){var e=this;if(t){if(!this.__retains[t])throw new Error("Dispose more than retaining !");this.__retains[t]=this.__retains[t]||0,this.__retains[t]--}if(0==this.__retains.all)throw new Error("Dispose more than retaining !");this.__retains.all--,this.__retains.all||(this._persistenceTm?(this._destroyTM&&clearTimeout(this._destroyTM),this._destroyTM=setTimeout(function(t){e._destroyTM=null,e.then(function(t){!e.__retains.all&&e.destroy()})},this._persistenceTm)):this.then(function(t){return!e.__retains.all&&e.destroy()}))}},{key:"destroy",value:function(){this.emit("destroy",this),this._stabilizer&&clearTimeout(this._stabilizer),this._followers.length&&this._followers.forEach(function(t){"function"!=typeof t[0]&&t[0].stores&&delete t[0].stores[t[1]]}),this._followers.length=0,this.dead=!0,this._revs=this.data=this.state=this.context=null,this.removeAllListeners()}},{key:"datas",get:function(){return this.data},set:function(t){this.data=t}}],[{key:"as",value:function(t){return{store:this,name:t}}},{key:"map",value:function(t,i,n,r){var a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=t._revs||{},u=t.stores||(t.stores={}),l={};i=c.array(i)?[].concat(s(i)):[i],n=n||e.staticContext,i=i.filter(function(e){if(!e)return!1;var i=void 0,s=void 0,r=void 0,h=void 0;return e.store&&e.name?(s=i=e.name,h=e.store):c.fn(e)?(i=s=e.name||e.defaultName,h=e):(e=e.match(/([\w_]+)((?:\.[\w_]+)*)(?:\:([\w_]+))?/),i=e[1],r=e[2]&&e[2].split(".").slice(1),h=n.stores[e[1]],s=e[3]||r&&r[r.length-1]||e[1]),!o[i]&&!!h&&(c.fn(h)?(n._mount(i),n.stores[i].bind(t,s,a,r)):h.bind(t,s,a,r),o[s]=o[s]||!0,!u[i]&&(u[i]=n.stores[i]),n.stores[i].hasOwnProperty("data")&&(l[i]=n.data[i]),!0)});var h,_=t.isReactComponent?"componentWillUnmount":"destroy";return t.hasOwnProperty(_)&&(h=t[_]),t[_]=function(){return delete t[_],h&&(t[_]=h),i.map(function(e){var i=void 0,s=void 0,r=void 0,a=void 0;e.store&&e.name?(s=i=e.name,a=e.store):c.fn(e)?(i=s=e.name||e.defaultName,a=n.stores[i]):(e=e.match(/([\w_]+)((?:\.[\w_]+)*)(?:\:([\w_]+))?/),i=e[1],r=e[2]&&e[2].split("."),a=n.stores[e[1]],s=e[3]||r&&r[r.length-1]||e[1]),a&&!c.fn(a)&&a.unBind(t,s,r)}),t[_]&&t[_].apply(t,arguments)},l}}]),e}(f);v.use=[],v.staticContext=new _({},{id:"static"}),v.state=void 0,v.defaultMaxListeners=100,v.persistenceTm=!1,e.default=v,t.exports=e.default}]);
//# sourceMappingURL=Rescope.nodeps.min.js.map
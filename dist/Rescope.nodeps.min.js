module.exports=function(t){function e(n){if(i[n])return i[n].exports;var r=i[n]={exports:{},id:n,loaded:!1};return t[n].call(r.exports,r,r.exports,e),r.loaded=!0,r.exports}var i={};return e.m=t,e.c=i,e.p="/",e(0)}([function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var r=i(2),s=n(r),o=i(5),a=n(o);s.default.Store=a.default,e.default={Store:a.default,Context:s.default},t.exports=e.default},function(t,e){t.exports=require("is")},function(t,e,i){"use strict";function n(t){if(Array.isArray(t)){for(var e=0,i=Array(t.length);e<t.length;e++)i[e]=t[e];return i}return Array.from(t)}function r(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var u=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),l=i(1),h=i(3),c=i(4),_=function(t,e,i){var n=function(){};n.prototype=i?new i["_"+e]:t[e]||{},t[e]=new n,t["_"+e]=n},f={},p=function(t){function e(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=i.id,r=i.parent,a=i.state,u=i.data,l=(i.name,i.defaultMaxListeners),h=i.persistenceTm,p=i.autoDestroy;s(this,e);var d=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));if(d._maxListeners=l||d.constructor.defaultMaxListeners,d._id=n=n||"_____"+c.generate(),f[n]){var v;return f[n].register(t),v=f[n],o(d,v)}if(f[n]=d,d._isLocalId=!0,d._persistenceTm=h||d.constructor.persistenceTm,d.stores={},d.state={},d.data={},r&&r.dead)throw new Error("Can't use a dead context as parent !");return _(d,"stores",r),_(d,"state",r),_(d,"data",r),d.parent=r,r&&r._addChild(d),d.sources=[],d._childContexts=[],d.__retains={all:0},d.__locks={all:1},d.__listening={},d.__context={},d.__mixed=[],d.__mixedList=[],d._followers=[],r&&(r.retain("isMyParent"),!r._stable&&d.wait("waitingParent"),r.on(d.__parentList={stable:function(t){return d.release("waitingParent")},unstable:function(t){return d.wait("waitingParent")},update:function(t){return d._propag()}})),d.register(t,a,u),d.__locks.all--,d._stable=!d.__locks.all,p&&setTimeout(function(t){d.retain("autoDestroy"),d.dispose("autoDestroy")}),d}return a(e,t),u(e,null,[{key:"getContext",value:function(t){var i=l.array(t)?t.sort(function(t,e){return t.firstname<e.firstname?-1:t.firstname>e.firstname?1:0}).join("::"):t;return f[i]=f[i]||new e({},{id:i})}}]),u(e,[{key:"mount",value:function(t,e,i){var n=this;return l.array(t)?t.forEach(function(t){return n._mount(t,e&&e[t],i&&i[t])}):this._mount.apply(this,arguments),this}},{key:"_mount",value:function(t,e,i){if("string"!=typeof t&&(this.register(r({},t.name,t.store)),t=t.name),!this.__context[t]){var n;if(this.__mixed.reduce(function(n,r){return n||r._mount(t,e,i)},!1)||!this.parent)return;return(n=this.parent)._mount.apply(n,arguments)}var s=this.__context[t];return l.fn(s)?this.__context[t]=new s(this,{state:e,data:i}):(void 0!==e&&void 0===i?s.setState(e):void 0!==e&&(s.state=e),void 0!==i&&s.push(i)),this._watchStore(t),this.__context[t]}},{key:"_watchStore",value:function(t,e,i){var n=this;if(!this.__context[t]){var r;if(this.__mixed.reduce(function(n,r){return n||r._watchStore(t,e,i)},!1)||!this.parent)return;return(r=this.parent)._watchStore.apply(r,arguments)}return this.__listening[t]||l.fn(this.__context[t])||(!this.__context[t].isStable()&&this.wait(t),this.__context[t].on(this.__listening[t]={destroy:function(e){delete n.__listening[t],n.__context[t]=n.__context[t].constructor},update:function(t){return n.propag()},stable:function(e){return n.release(t)},unstable:function(e){return n.wait(t)}})),!0}},{key:"mixin",value:function(t){var e=this,i=this.parent,n=void 0;this.__mixed.push(t),t.retain("mixedTo"),t._stable||this.wait(t._id),this.__mixedList.push(n={stable:function(i){return e.release(t._id)},unstable:function(i){return e.wait(t._id)},update:function(t){return e._propag()}}),this.stores={},this.state={},this.data={},t.on(n),_(this,"stores",i),_(this,"state",i),_(this,"data",i),this.relink(this.__context,this,!1,!0),this.__mixed.forEach(function(t){_(e,"stores"),_(e,"state"),_(e,"data"),t.relink(t.__context,e,!0,!0)})}},{key:"register",value:function(t){var e=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.relink(t,this,!1,!1,i,n),Object.keys(t).forEach(function(r){l.fn(t[r])?t[r].singleton&&e._mount(r,i[r],n[r]):e._watchStore(r)})}},{key:"relink",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this,i=arguments[2],n=arguments[3],r=this,s=(arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},e._stores.prototype);Object.keys(t).forEach(function(o){if(!(!n&&e.__context[o]===t[o]||e.__context[o]&&e.__context[o].constructor===t[o])){if(!n&&e.__context[o])return i||l.fn(e.__context[o])||(e.__context[o].__proto__=t[o].prototype),void(!i&&l.fn(e.__context[o])&&(e.__context[o]=t[o]));n||i||(r.__context[o]=t[o]),Object.defineProperty(s,o,{get:function(){return r.__context[o]}}),Object.defineProperty(e._state.prototype,o,{get:function(){return r.__context[o]&&r.__context[o].state},set:function(t){return r._mount(o,t)}}),Object.defineProperty(e._data.prototype,o,{get:function(){return r.__context[o]&&r.__context[o].data},set:function(t){return r._mount(o,void 0,t)}})}})}},{key:"bind",value:function(t,e,i){var n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],s=void 0,o=void 0,a=void 0;if(e&&!l.array(e)&&(e=[e]),i!==!1&&i!==!0||(n=i,i=null),a=e.map(function(t){return l.string(t)?t:t.name}),this._followers.push([t,e,i||void 0,s=a&&a.reduce(function(t,e){return t[e]=0,t},{})]),this.mount(e),n&&this._stable){if(o=this.getUpdates(s),!o)return;"function"!=typeof t?i?t.setState(r({},i,o)):t.setState(o):t(o)}return this}},{key:"unBind",value:function(t,e,i){for(var n=this._followers,r=n&&n.length;n&&r--;)if(n[r][0]===t&&""+n[r][1]==""+e&&n[r][2]==i)return n.splice(r,1)}},{key:"map",value:function(t,e){var i=this,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=this.constructor.Store;if(e=l.array(e)?e:[e],this.mount(e),n&&t instanceof r)r.map(t,e,this,this,!1);else if(n){this.bind(t,e,void 0,!1);var s=void 0,o=t.isReactComponent?"componentWillUnmount":"destroy";t.hasOwnProperty(o)&&(s=t[o]),t[o]=function(){return delete t[o],s&&(t[o]=s),i.unBind(t,e),t[o]&&t[o].apply(t,arguments)}}return e.reduce(function(t,e){return l.string(e)||(e=e.name),e=e.split(":"),e[0]=e[0].split("."),t[e[1]||e[0][e[0].length-1]]=i.stores[e[0][0]]&&i.stores[e[0][0]].retrieve(e[0].splice(1)),t},{})}},{key:"retrieve",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return t=l.string(t)?t.split("."):t,t&&this.stores[t[0]]&&this.stores[t[0]].retrieve(t.splice(1))}},{key:"getStoresRevs",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments[1],i=this.__context;return t||(t={}),Object.keys(i).forEach(function(e){l.fn(i[e])?t.hasOwnProperty(e)||(t[e]=!1):t[e]=i[e]._rev}),e||(this.__mixed.reduce(function(e,i){return i.getStoresRevs(t),t},t),this.parent&&this.parent.getStoresRevs(t)),t}},{key:"getUpdates",value:function(t,e,i){var n=this,r=this.__context;return e=e||{},Object.keys(r).forEach(function(s){e[s]||t&&(!t.hasOwnProperty(s)||void 0!==t[s])&&(!t.hasOwnProperty(s)||r[s]._rev<=t[s])||(i=!0,e[s]=n.data[s],t&&void 0!==t[s]&&(t[s]=r[s]._rev))}),i=this.__mixed.reduce(function(i,n){return n.getUpdates(t,e,i)||i},i),i=this.parent&&this.parent.getUpdates(t,e,i)||i,i&&e}},{key:"serialize",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:/.*/,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:/.*/,n=this.__context,r={state:{},data:{}},s=void 0,o=void 0;return l.array(e)&&e.forEach(function(e){return r.state[e]=t.state[e]}),l.array(i)&&i.forEach(function(e){return r.data[e]=t.data[e]}),l.array(i)||l.array(e)||Object.keys(n).forEach(function(e){if(!l.fn(n[e])){var i=n[e].constructor.flags;i=l.array(i)?i:[i||""],i.reduce(function(t,e){return t||s.test(e)},!1)&&(r.state[e]=t.state[e]),i.reduce(function(t,e){return t||o.test(e)},!1)&&(r.data[e]=t.data[e])}}),r}},{key:"dispatch",value:function(t,e){var i=this;return Object.keys(this.__context).forEach(function(n){l.fn(i.__context[n])||i.__context[n].trigger(t,e)}),this.__mixed.forEach(function(i){return i.dispatch(t,e)}),this.parent&&this.parent.dispatch(t,e),this}},{key:"then",value:function(t){var e=this;return this._stable?t(null,this.data):void this.once("stable",function(i){return t(null,e.data)})}},{key:"restore",value:function(t,e){var i=t.state,n=t.data,r=this.__context;Object.keys(n).forEach(function(t){e?r.data=n[t]:r.push(n[t])}),Object.keys(i).forEach(function(t){e?r.state=i[t]:r.setState(i[t])})}},{key:"retainStores",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],i=arguments[1];e.forEach(function(e){return t.stores[e]&&t.stores[e].retain&&t.stores[e].retain(i)})}},{key:"disposeStores",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],i=arguments[1];e.forEach(function(e){return t.stores[e]&&t.stores[e].dispose&&t.stores[e].dispose(i)})}},{key:"wait",value:function(t){this._stable&&!this.__locks.all&&this.emit("unstable",this),this._stable=!1,this.__locks.all++,t&&(this.__locks[t]=this.__locks[t]||0,this.__locks[t]++)}},{key:"release",value:function(t){var e=this;t&&(0==this.__locks[t],this.__locks[t]=this.__locks[t]||0,this.__locks[t]--),!t&&0==this.__locks.all,this.__locks.all--,this.__locks.all||(this._stabilizerTM&&clearTimeout(this._stabilizerTM),this._stabilizerTM=setTimeout(function(t){e._stabilizerTM=null,e.__locks.all||(e._propagTM&&clearTimeout(e._propagTM),e._stable=!0,e.emit("stable",e),!e.dead&&e._propag())}))}},{key:"propag",value:function(){var t=this;this._propagTM&&clearTimeout(this._propagTM),this._propagTM=setTimeout(function(e){t._propagTM=null,t._propag()},2)}},{key:"_propag",value:function(){var t=this;this._followers.length&&this._followers.forEach(function(e){var i=e[0],s=(e[1],e[2]),o=e[3],a=t.getUpdates(o);a&&("function"!=typeof i?s?i.setState(r({},s,a)):i.setState(a):i(a,o&&[].concat(n(o))||"no revs"))}),this.emit("update",this.getUpdates())}},{key:"isStable",value:function(){return this._stable}},{key:"_getAllChilds",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return t.push.apply(t,n(this._childContexts)),this._childContexts.forEach(function(e){e._getAllChilds(t)}),t}},{key:"_addChild",value:function(t){this._childContexts.push(t)}},{key:"_rmChild",value:function(t){var e=this._childContexts.indexOf(t);e!=-1&&this._childContexts.splice(e,1)}},{key:"retain",value:function(t){this.__retains.all++,t&&(this.__retains[t]=this.__retains[t]||0,this.__retains[t]++)}},{key:"dispose",value:function(t){var e=this;if(t){if(0==this.__retains[t])throw new Error("Dispose more than retaining !");this.__retains[t]=this.__retains[t]||0,this.__retains[t]--}if(0==this.__retains.all)throw new Error("Dispose more than retaining !");this.__retains.all--,this.__retains.all||(this._persistenceTm?(this._destroyTM&&clearTimeout(this._destroyTM),this._destroyTM=setTimeout(function(t){e.then(function(t){!e.__retains.all&&e.destroy()})},this._persistenceTm)):this.then(function(t){return!e.__retains.all&&e.destroy()}))}},{key:"destroy",value:function(){var t=this;for(this.__context,this.dead=!0,this.emit("destroy"),Object.keys(this.__listening).forEach(function(e){return t.__context[e].removeListener(t.__listening[e])}),this._stabilizerTM&&clearTimeout(this._stabilizerTM),this._propagTM&&clearTimeout(this._propagTM),this.__listening={},this._isLocalId&&delete f[this._id],this._followers.length=0;this.__mixedList.length;)this.__mixed[0].removeListener(this.__mixedList.shift()),this.__mixed.shift().dispose("mixedTo");this.__parentList&&(this.parent._rmChild(this),this.parent.removeListener(this.__parentList),this.parent.dispose("isMyParent"),this.__parentList=null),this.__mixed=this.data=this.state=this.context=this.stores=null,this._data=this._state=this._stores=null}},{key:"datas",get:function(){return this.data}}]),e}(h);p.persistenceTm=1,p.Store=null,p.contexts=f,e.default=p,t.exports=e.default},function(t,e,i){"use strict";function n(t){if(Array.isArray(t)){for(var e=0,i=Array(t.length);e<t.length;e++)i[e]=t[e];return i}return Array.from(t)}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var s=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),o=i(1),a=function(){function t(){r(this,t),this._events={}}return s(t,[{key:"on",value:function(t,e){var i=this;return!o.string(t)&&t?Object.keys(t).forEach(function(e){return i.on(e,t[e])}):(this._events[t]=this._events[t]||[],void this._events[t].push(e))}},{key:"un",value:function(t,e){var i=this;if(!o.string(t)&&t)return Object.keys(t).forEach(function(e){return i.un(e,t[e])});if(this._events[t]){var n=this._events[t].indexOf(e);this._events[t].splice(n,1)}}},{key:"emit",value:function(t){if(this._events[t]){for(var e=[].concat(n(this._events[t])),i=arguments.length,r=Array(i>1?i-1:0),s=1;s<i;s++)r[s-1]=arguments[s];for(var o=0;o<e.length;o++)e[o].apply(e,r)}}},{key:"addListener",value:function(){this.on.apply(this,arguments)}},{key:"removeListener",value:function(){this.un.apply(this,arguments)}},{key:"removeAllListeners",value:function(){this._events={}}},{key:"once",value:function(t,e){var i=this,n=void 0;this.on(t,n=function(){i.un(t,n),e.apply(void 0,arguments)})}}]),t}();e.default=a,t.exports=e.default},function(t,e){t.exports=require("shortid")},function(t,e,i){"use strict";function n(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function r(t){if(Array.isArray(t)){for(var e=0,i=Array(t.length);e<t.length;e++)i[e]=t[e];return i}return Array.from(t)}function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var u=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t},l=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),h=function t(e,i,n){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,i);if(void 0===r){var s=Object.getPrototypeOf(e);return null===s?void 0:t(s,i,n)}if("value"in r)return r.value;var o=r.get;return void 0!==o?o.call(n):void 0},c=i(1),_=i(2),f=i(3),p=i(4),d=Object.getPrototypeOf({}),v=function(t){function e(){var t,i;s(this,e);var n=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this)),a=[].concat(Array.prototype.slice.call(arguments)),l=n.constructor,h=a[0]instanceof _?a.shift():l.context?_.getContext(l.context):c.string(a[0])?_.getContext(a.shift()):l.staticContext,f=!a[0]||c.array(a[0])||c.string(a[0])?{}:a.shift(),d=c.string(a[0])?a[0]:f.name||l.name,v=c.array(a[0])?a.shift():f.use||[],y=c.fn(a[0])?a.shift():f.apply||null,g=l.state||l.initialState;return n._uid=f._uid||p.generate(),n._maxListeners=f.defaultMaxListeners||e.defaultMaxListeners,n.__retains={all:0},n.__locks={all:0},n._onStabilize=[],n._persistenceTm=f.persistenceTm||n.constructor.persistenceTm,c.string(a[0])&&(h.__context[d],h.__context[d]=n),f&&f.on&&n.on(f.on),n.name=d,h.stores?(n.contextObj=h,n.context=h.stores):(n.contextObj=new _(h),n.context=h.stores),n._rev=0,n._revs={},n.stores={},n._require=[],c.array(l.use)?n._use=[].concat(r(v),r((l.use||[]).map(function(t){var e=t.match(/^(\!?)([^\:]*)(?:\:(.*))?$/);if(e[1]){var i=e[2].split(".");n._require.push(e[3]||i[i.length-1])}return e[2]}))):n._use=[].concat(r(v),r(l.use?Object.keys(l.use).map(function(t){var e=t.match(/^(\!?)(.*)$/);return e[1]&&n._require.push(l.use[t]),e[2]+":"+l.use[t]}):[])),l.require&&(t=n._require).push.apply(t,r(l.require)),f.require&&(i=n._require).push.apply(i,r(f.require)),n._followers=[],void 0!==l.data&&(n.data=u({},l.data)),f.hasOwnProperty("data")&&void 0!==f.data&&(n.data=f.data),f.hasOwnProperty("state")&&void 0!==f.state&&(g=u({},g,f.state)),y&&(n.apply=y),(g||n._use.length)&&(n.state=u({},g||{},h.map(n,n._use)),n.shouldApply(n.state)&&void 0===n.data&&(n.data=n.apply(n.data,n.state,n.state))),void 0!==n.data?(n._stable=!0,n._rev++):(n._stable=!1,!(n.state||n._use&&n._use.length)),!n._stable&&n.emit("unstable",n.state),n}return a(e,t),l(e,[{key:"shouldPropag",value:function(t){var e,i=(this.constructor,this.data);return e=!i&&t,i&&Object.keys(i).forEach(function(n){e=e||(t?i[n]!==t[n]:i&&i[n])}),t&&Object.keys(t).forEach(function(n){e=e||(t?i[n]!==t[n]:i&&i[n])}),!!e}},{key:"shouldApply",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.state,i=this.constructor;return this.isComplete(e)&&c.array(i.follow)?i.follow.reduce(function(t,i){return t||e&&e[i]},!1):!i.follow||Object.keys(i.follow).reduce(function(n,r){return n||e&&c.fn(i.follow[r])&&i.follow[r].call(t,e[r])||i.follow[r]&&e[r]!==t.state[r]},!1)}},{key:"apply",value:function(t,e,i){return e=e||this.state,this.refine?this.refine.apply(this,arguments):t&&t.__proto__===d&&e.__proto__===d?u({},t,e):e}},{key:"refine",value:function(t,e,i){return e=e||this.state,t&&t.__proto__===d&&e.__proto__===d?u({},t,e):e}},{key:"stabilize",value:function(t){var e=this;t&&this.once("stable",t),this._stable&&this.emit("unstable",this.state,this.data),this._stable=!1,this._stabilizer&&clearTimeout(this._stabilizer),this._stabilizer=setTimeout(this.push.bind(this,null,function(){var t=e._stable;e._stable=!0,!t&&e.emit("stable",e.state,e.data),e._stabilizer=null}))}},{key:"retrieve",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.data;return t=c.string(t)?t.split("."):t,i&&t&&t.length?t.length==e+1?i[t[e]]:this.retrieve(t,e+1,i[t[e]]):i}},{key:"dispatch",value:function(t){for(var e,i=arguments.length,n=Array(i>1?i-1:0),r=1;r<i;r++)n[r-1]=arguments[r];(e=this.contextObj).dispatch.apply(e,[t].concat(n))}},{key:"trigger",value:function(t){var e=this.constructor.actions,i=void 0;if(e&&e[t]){for(var n,r=arguments.length,s=Array(r>1?r-1:0),o=1;o<r;o++)s[o-1]=arguments[o];i=(n=e[t]).call.apply(n,[this].concat(s)),i&&this.setState(i)}}},{key:"pull",value:function(t,e,i){var n=this,r=this.contextObj.map(this,t);return e&&(this.wait(),t.forEach(function(t){return n.context[t]&&n.wait(n.context[t])}),this.release()),r}},{key:"push",value:function(t,e,i){i=e===!0?i:e,e=e===!0;var n=!t&&u({},this.state,this._changesSW)||this.state,r=t||this.apply(this.data,n,this._changesSW);return this.state=n,e||(this.data||this.data!==r)&&this.shouldPropag(r)?(this.data=r,this._changesSW={},this.wait(),void this.release(i)):(i&&i(),!1)}},{key:"setState",value:function(t,e,i){var n,r=this._changesSW=this._changesSW||{};for(var s in t)(!this.state||t.hasOwnProperty(s)&&(t[s]!=this.state[s]||this.state[s]&&t[s]&&t[s]._rev!=this._revs[s]))&&(n=!0,this._revs[s]=t[s]&&t[s]._rev||!0,r[s]=t[s]);if(this.shouldApply(u({},this.state,r)))return i?(this.push(),e&&e()):n?this.stabilize(e):e&&e(),this}},{key:"setStateSync",value:function(t){var e,i=this._changesSW=this._changesSW||{};for(var n in t)(!this.state||t.hasOwnProperty(n)&&(t[n]!=this.state[n]||this.state[n]&&t[n]&&t[n]._rev!=this._revs[n]))&&(e=!0,this._revs[n]=t[n]&&t[n]._rev||!0,i[n]=t[n]);return this.push(),this.data}},{key:"replaceState",value:function(t,e){this.state=t,this.stabilize(e)}},{key:"as",value:function(t){return{store:this,name:t}}},{key:"on",value:function(t){var i=this;!c.string(t)&&t?Object.keys(t).forEach(function(n){return h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"on",i).call(i,n,t[n])}):h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"on",this).apply(this,arguments)}},{key:"removeListener",value:function(t){var i=this;!c.string(t)&&t?Object.keys(t).forEach(function(n){return h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"removeListener",i).call(i,n,t[n])}):h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"removeListener",this).apply(this,arguments)}},{key:"relink",value:function(t){var e=this,i=this.contextObj,n=this.constructor;n.use&&this.pull(n.use,!1,t),this._require&&this._require.forEach(function(t){return e.wait(i.__context[t])})}},{key:"isComplete",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.state;return this.constructor,!this._require||!this._require.length||t&&this._require.reduce(function(e,i){return e&&t[i]},!0)}},{key:"isStable",value:function(){return this._stable}},{key:"unBind",value:function(t,e,i){for(var n=this._followers,r=n&&n.length;n&&r--;)if(n[r][0]===t&&n[r][1]===e&&n[r][2]===i)return n.splice(r,1)}},{key:"bind",value:function(t,e){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=arguments[3];if(this._followers.push([t,e,r]),i&&this.data&&this._stable){var s=r?this.retrieve(r):this.data;"function"!=typeof t?e?t.setState(n({},e,s)):t.setState(s):t(s)}}},{key:"then",value:function(t){var e=this;return this._stable?t(null,this.data):void this.once("stable",function(i){return t(null,e.data)})}},{key:"wait",value:function(t){if("number"==typeof t)return this.__locks.all+=t;if(c.array(t))return t.map(this.wait.bind(this));this._stable&&this.emit("unstable",this.state,this.data),this._stable=!1,this.__locks.all++;var e=c.string(t)?t:null;return e&&(this.__locks[e]=this.__locks[e]||0,this.__locks[e]++),t&&c.fn(t.then)&&t.then(this.release.bind(this,null)),this}},{key:"release",value:function(t,e){var i=this,r=(this.constructor,this._stable);return c.fn(t)&&(e=t,t=null),t&&(0==this.__locks[t],this.__locks[t]=this.__locks[t]||0,this.__locks[t]--),!t&&0==this.__locks.all,!--this.__locks.all&&this.data&&this.isComplete()?(this._stable=!0,this._rev++,this._followers.length&&this._followers.forEach(function(t){var e=t[2]?i.retrieve(t[2]):i.data;e&&("function"==typeof t[0]?t[0](e):t[0].setState(t[1]?n({},t[1],e):e))}),!r&&this.emit("stable",this.data),this.emit("update",this.data),e&&e()):e&&this.then(e),this}},{key:"retain",value:function(t){this.__retains.all++,t&&(this.__retains[t]=this.__retains[t]||0,this.__retains[t]++)}},{key:"dispose",value:function(t){var e=this;if(t){if(!this.__retains[t])throw new Error("Dispose more than retaining !");this.__retains[t]=this.__retains[t]||0,this.__retains[t]--}if(0==this.__retains.all)throw new Error("Dispose more than retaining !");this.__retains.all--,this.__retains.all||(this._persistenceTm?(this._destroyTM&&clearTimeout(this._destroyTM),this._destroyTM=setTimeout(function(t){e._destroyTM=null,e.then(function(t){!e.__retains.all&&e.destroy()})},this._persistenceTm)):this.then(function(t){return!e.__retains.all&&e.destroy()}))}},{key:"destroy",value:function(){this.emit("destroy",this),this._stabilizer&&clearTimeout(this._stabilizer),this._followers.length&&this._followers.forEach(function(t){"function"!=typeof t[0]&&t[0].stores&&delete t[0].stores[t[1]]}),this._followers.length=0,this.dead=!0,this._revs=this.data=this.state=this.context=null,this.removeAllListeners()}},{key:"datas",get:function(){return this.data},set:function(t){this.data=t}}],[{key:"as",value:function(t){return{store:this,name:t}}},{key:"map",value:function(t,i,n,s){var o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=t._revs||{},u=t.stores||(t.stores={}),l={};i=c.array(i)?[].concat(r(i)):[i],n=n||e.staticContext,i=i.filter(function(e){if(!e)return!1;var i=void 0,r=void 0,s=void 0,h=void 0;return e.store&&e.name?(r=i=e.name,h=e.store):c.fn(e)?(i=r=e.name||e.defaultName,h=e):(e=e.match(/([\w_]+)((?:\.[\w_]+)*)(?:\:([\w_]+))?/),i=e[1],s=e[2]&&e[2].split(".").slice(1),h=n.stores[e[1]],r=e[3]||s&&s[s.length-1]||e[1]),!a[i]&&!!h&&(c.fn(h)?(n._mount(i),n.stores[i].bind(t,r,o,s)):h.bind(t,r,o,s),a[r]=a[r]||!0,!u[i]&&(u[i]=n.stores[i]),n.stores[i].hasOwnProperty("data")&&(l[i]=n.data[i]),!0)});var h,_=t.isReactComponent?"componentWillUnmount":"destroy";return t.hasOwnProperty(_)&&(h=t[_]),t[_]=function(){return delete t[_],h&&(t[_]=h),i.map(function(e){var i=void 0,r=void 0,s=void 0,o=void 0;e.store&&e.name?(r=i=e.name,o=e.store):c.fn(e)?(i=r=e.name||e.defaultName,o=n.stores[i]):(e=e.match(/([\w_]+)((?:\.[\w_]+)*)(?:\:([\w_]+))?/),i=e[1],s=e[2]&&e[2].split("."),o=n.stores[e[1]],r=e[3]||s&&s[s.length-1]||e[1]),o&&!c.fn(o)&&o.unBind(t,r,s)}),t[_]&&t[_].apply(t,arguments)},l}}]),e}(f);v.use=[],v.staticContext=new _({},{id:"static"}),v.initialState=void 0,v.state=void 0,v.defaultMaxListeners=100,v.persistenceTm=!1,e.default=v,t.exports=e.default}]);
//# sourceMappingURL=Rescope.nodeps.min.js.map